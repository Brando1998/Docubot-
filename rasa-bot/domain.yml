version: "3.1"

intents:
  - greet
  - goodbye
  - affirm
  - deny
  - ask_info
  - solicitar_manifiesto
  - informar_datos
  - nlu_fallback

entities:
  - flete
  - descripcion
  - peso
  - fecha_cargue
  - fecha_descargue
  - tarjeta
  - licencia
  - origen
  - destino

slots:
  flete:
    type: float
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: flete
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: flete

  descripcion:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: descripcion
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: descripcion

  peso:
    type: float
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: peso
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: peso

  fecha_cargue:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: fecha_cargue
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: fecha_cargue

  fecha_descargue:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: fecha_descargue
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: fecha_descargue

  tarjeta:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: tarjeta
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: tarjeta

  licencia:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: licencia
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: licencia

  origen:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: origen
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: origen

  destino:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: destino
      intent: informar_datos
    - type: from_text
      intent: informar_datos
      conditions:
      - active_loop: manifiesto_form
        requested_slot: destino

  manifiesto_confirmado:
    type: bool
    influence_conversation: true
    mappings:
    - type: custom
      action: action_set_manifiesto_confirmed

responses:
  utter_greet:
    - text: "¡Hola! Soy tu asistente para generar manifiestos de carga. ¿En qué puedo ayudarte?"
  
  utter_goodbye:
    - text: "¡Hasta luego! Que tengas un buen día."
    - text: "¡Adiós! Estamos aquí si nos necesitas de nuevo."
    - text: "Fue un placer ayudarte. ¡Hasta pronto!"

  utter_pedir_flete:
    - text: "Por favor indícame el valor del flete (ej: 150000 o $150,000)"

  utter_pedir_descripcion:
    - text: "Descríbeme la carga que transportarás (ej: cajas de electrodomésticos)"

  utter_pedir_peso:
    - text: "¿Cuál es el peso total de la carga? (ej: 500 kg)"

  utter_pedir_fecha_cargue:
    - text: "¿Cuándo se realizará el cargue? (ej: 15/08/2023 8:00 AM)"

  utter_pedir_fecha_descargue:
    - text: "¿Cuándo se realizará la descarga? (ej: 16/08/2023 5:00 PM)"

  utter_pedir_tarjeta:
    - text: "Ingresa el número de la tarjeta de propiedad del vehículo"

  utter_pedir_licencia:
    - text: "Por favor comparte el número de tu licencia de conducción"

  utter_pedir_origen:
    - text: "¿Desde dónde partirá la carga? (ciudad/dirección)"

  utter_pedir_destino:
    - text: "¿Cuál es el destino final de la carga? (ciudad/dirección)"

  utter_confirmar_manifiesto:
    - text: "Revisemos los datos:\n\nFlete: {flete}\nDescripción: {descripcion}\nPeso: {peso}\nCargue: {fecha_cargue}\nDescargue: {fecha_descargue}\nTarjeta: {tarjeta}\nLicencia: {licencia}\nOrigen: {origen}\nDestino: {destino}\n\n¿Todo está correcto?"

  utter_manifiesto_generado:
    - text: "¡Manifiesto generado con éxito! En un momento recibirás el documento."

  utter_preguntar_otro_dato:
    - text: "¿Qué otro dato necesitas proporcionar?"
  
  utter_fallback:
    - text: "Lo siento, no entendí eso. ¿Podrías reformularlo?"
    - text: "No estoy seguro de haber captado tu mensaje. ¿Podrías decirlo de otra forma?"
    - text: "Mis disculpas, no pude entender. ¿Me lo repites con otras palabras?"



forms:
  manifiesto_form:
    required_slots:
      - flete
      - descripcion
      - peso
      - fecha_cargue
      - fecha_descargue
      - tarjeta
      - licencia
      - origen
      - destino
    ignored_intents:
      - greet
      - goodbye

actions:
  - action_validate_manifiesto
  - action_submit_manifiesto
  - action_default_fallback
  - action_set_manifiesto_confirmed